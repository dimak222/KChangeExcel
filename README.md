# KChangeExcel
Изменение св-в дет. и СБ из Exсel.
 
## Правила использования
1. Тёмно-синие колонки (первые три "№", "Обозначение старое", "Наименование старое" и последняя "Изменено") менять местами и удалять нельзя!
2. Колонки между Тёмно-синими колонками, можно менять, удалять и добавлять в любом порядке.
3. При запуске программы, её "Настройки" считываются с Excel файла, если листа нет или все настройки не заданы, будут использоватся "Настройки по умолчанию" (заданные в программе).
4. При включении опции "check_update" будет проводиться проверка обновления (с GitHub) при каждом запуске программы, при обнаружении новой версии будет предложено скачать новый exe файл который перезапишет старый.
5. При включении опции "Marking_and_Name_by_source" у всех дет. и СБ будет проверена и включены св-ва обозначение и наименование "По источнику".
6. Обработка файлов идёт по порядку вставки их в СБ, копии разных по имени файлов (если "force_processing" = False) и массивы игнорируються (изменяются по изм. главного файла в массиве).
7. Для удобства, можно сортировать колонки таблицы. 
   При одинаковых значениях в колонке ""Обозначение старое"", оба значения будут выделены в красный цвет (т.к. если не меняется обозначение может произойти перезапись уже изменённой дет. последним введёным значением).
   Для наглядности сделанно выделение одинаковых значений в колонках  ""Обозначение старое"", ""Наименование старое"" и  ""Обозначение"", ""Наименование"" соответственно (если не требуется менять Об. и Наим. их необязательно заполнять).
   Для понимания прогресса (если нет значения, поиск по этой строке не проводился) и результатов изменения, в колонку ""Изменено"" вписываются значения ""Да"" (дет. изм.), ""Нет"" (дет. не требует изм.), ""Не найдено"", с соответствующим цветом.
   В найденых дет. (""Да"" и ""Нет"") присутствует гиперссылка на дет.
   Для работы колонки ""Изменено"" необходимо закрыть Excel и запустить обработку."
8. Если одновременно введены значения в "Обозначение старое" и "Наименование старое", поиск идёт только когда оба значения совпадают.
9. При записанном значении только в колонке "Обозначение старое" поиск идёт только по обозначению.
10. При записанном значении только в колонке "Наименование старое" поиск идёт только по наименованию.
11. "При записи в обозначение исп. (-01, -02….) и кода документа (СБ, ГЧ, МЧ…), они распределяються в соответствующие колонки в КОМПАСе.
    В кололонку ""Обозначение старое"" необязательно прописывать код документа, поиск происходит без кода док."
12. Если в значение колонки ничего не вписанно, в дет. оно не изменяется.
13. Если в значение колонки вписать "delete" (без ковычек), в дет. оно удалится.
14. "При изменении номера исп. в дет. имеющее исп., ""нулевой"" номер исп. будет начинаться с значения введёного в колонку ""Обозначение"".
    Пример: дет. имеет 3 исп. (АБВГ.123456.001, АБВГ.123456.001-01, АБВГ.123456.001-02), если изменить обозначение АБВГ.123456.001-01 => АБВГ.123456.001-03, то дет. будет иметь исп. АБВГ.123456.001-03, АБВГ.123456.001-04, АБВГ.123456.001-05."
15. "При отсутствии св-в в док. св-ва берутся из наименования файла введённого в ""property_library"".
16. Путь расположения библиотеки определяется сам, файл необходимо расположить в папке ""Sys"" установленного КОМПАСа (""C:\Program Files\ASCON\KOMPAS-3D vXX\Sys"")."
В конце обработки будет выведено сообщение "Обработка модели закончена!".
